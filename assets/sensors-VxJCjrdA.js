import{r as D,i as S,j as e,c as C,e as d,o as F,B as s,T as i,q as h,D as R,u as H,G as _,t as k}from"./index-yESpCeQD.js";/* empty css               */import{P as N}from"./PrimaryButton-5mT3A8zm.js";import{C as M}from"./Container-zjyhton9.js";import{C as z}from"./Card-atDsQMDj.js";import{D as E,a as $,b as q,c as L}from"./DialogTitle-8cDMejvo.js";import{T}from"./TextField-JlTXMkYs.js";import{S as U,u as G}from"./SummaryColumn-2xPaGwC1.js";import{B as V}from"./ButtonCard-BWXdXwzu.js";import{g as J}from"./getIcon-JFxujHy_.js";import"./Select-fA180htR.js";import"./Opacity-IPVGax74.js";var b={},K=S;Object.defineProperty(b,"__esModule",{value:!0});var O=b.default=void 0,Q=K(D()),X=e;O=b.default=(0,Q.default)((0,X.jsx)("path",{d:"M17 1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2m0 18H7V5h10zM12 6.72c-1.96 0-3.5 1.52-3.5 3.47h1.75c0-.93.82-1.75 1.75-1.75s1.75.82 1.75 1.75c0 1.75-2.63 1.57-2.63 4.45h1.76c0-1.96 2.62-2.19 2.62-4.45 0-1.96-1.54-3.47-3.5-3.47m-.88 8.8h1.76v1.76h-1.76z"}),"DeviceUnknown");const Y=({display:t,setShowAddDeviceModal:r})=>{const{setHasDevice:a,setDeviceID:u}=C(),[n,g]=d.useState({device_id:"",device_name:""}),[,,,,v]=F(),[m,x]=d.useState(!1),[o,l]=d.useState(""),p=f=>{const{name:j,value:c}=f.target;g(B=>({...B,[j]:c}))},A=async f=>{const j="https://api.gardenguardian.app:8443/";f.preventDefault();try{const c=await v(j+"users/addDevice",n);if(!c||c.status!==201){console.log("There was an error adding the device. Please try again."),x(!0),l(c?c.message:"There was an error adding the device. Please try again.");return}console.log("Device added successfully"),u(n.device_id),a(!0),r(!1)}catch(c){console.error(c)}};return t?e.jsx("div",{className:"modal-wrapper",children:e.jsx(M,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(z,{variant:"light",sx:{padding:2,maxWidth:{md:"100%",lg:"100%"}},component:"form",onSubmit:A,noValidate:!0,children:[e.jsx(O,{fontSize:"large",sx:{color:"green"}}),e.jsx(E,{children:"Add a Device"}),e.jsxs($,{children:[e.jsx(q,{sx:{paddingBottom:2},children:"Oops! It looks like you haven't added a device yet. Please enter your Device ID to get started."}),e.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(T,{id:"deviceIDField",name:"device_id",label:"Device ID",type:"text",margin:"normal",color:"primary",size:"small",variant:"outlined",value:n.ID,onChange:p,error:m,helperText:o}),e.jsx(T,{id:"deviceNameField",name:"device_name",label:"Enter a Name for your Device",type:"text",margin:"normal",color:"primary",size:"small",variant:"outlined",value:n.Name,onChange:p})]})]}),e.jsx(L,{sx:{justifyContent:"center"},children:e.jsx(N,{text:"Submit",type:"submit"})})]})})}):null};var w={},Z=S;Object.defineProperty(w,"__esModule",{value:!0});var P=w.default=void 0,ee=Z(D()),te=e;P=w.default=(0,ee.default)((0,te.jsx)("path",{d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0 2c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m-1-10v4h2v-4h3l-4-4-4 4z"}),"ArrowCircleUpOutlined");var I={},re=S;Object.defineProperty(I,"__esModule",{value:!0});var W=I.default=void 0,ae=re(D()),se=e;W=I.default=(0,ae.default)((0,se.jsx)("path",{d:"M12 4c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8m0-2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 10V8h-2v4H8l4 4 4-4z"}),"ArrowCircleDownOutlined");const y=({difference:t,sensor:r})=>e.jsx(s,{sx:{display:"flex",gap:"1rem"},children:t[r]!==0&&!isNaN(t[r])?t[r]>0?e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsxs(i,{variant:"caption",fontWeight:"bold",children:["Increase By ",t[r]," ",r.includes("Humidity")?"%":"°C"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsxs(i,{variant:"caption",fontWeight:"bold",children:["Decrease By ",Math.abs(t[r])," ",r.includes("Humidity")?"%":"°C"]})]}):null}),ne=({sensorData:t,difference:r})=>{const a=t[h.temperature],u=t[h.humidity],n=t[h.waterTemp];return e.jsxs(s,{name:"sensorBanner",sx:{backgroundColor:"background.lightGrey",padding:"1rem"},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(y,{difference:r,sensor:h.temperature}),e.jsx(i,{variant:"caption",fontWeight:"bold",children:"Current Conditions"})]}),e.jsx(s,{sx:{textAlign:"left"},children:e.jsxs(i,{variant:"h4",fontWeight:"bold",children:["Temperature: ",a,"°C"]})}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",paddingTop:"1rem"},children:[e.jsxs(s,{children:[e.jsx(y,{difference:r,sensor:h.humidity}),e.jsxs(i,{variant:"body1",fontWeight:"bold",children:["Humidity: ",u,"%"]})]}),e.jsx(R,{orientation:"vertical",flexItem:!0,sx:{width:"5px"}}),e.jsxs(s,{children:[e.jsx(y,{difference:r,sensor:h.waterTemp}),e.jsxs(i,{variant:"body1",fontWeight:"bold",children:["Water Temp: ",n,"°C"]})]})]})]})},ie=t=>{const[r,a]=d.useState("°C");return t==="Humidity Sensor"?"%":t==="PH"?" pH":t==="TDS"?" ppm":" "+r},oe=(t,r)=>{switch(t){case"PH":return r[t]<=5||r[t]>=7?"error.main":r[t]<5.8||r[t]>6.3?"warning.main":"success.main";default:return"primary.secondary"}},le=({sensor:t,sensorData:r,Icon:a})=>e.jsxs(e.Fragment,{children:[a&&e.jsx(a,{sx:{fontSize:80,color:oe(t,r)}}),e.jsxs(s,{children:[e.jsx(i,{variant:"caption",fontWeight:"bold",color:"text.subtitle",children:"Latest Reading"}),e.jsxs(i,{variant:"body1",color:"text.cardTitle",fontWeight:600,children:[r[t],ie(t)]})]})]}),ce=({sensorData:t})=>{const r=H();return e.jsxs(s,{sx:{paddingTop:"3rem"},children:[e.jsx(i,{variant:"h5",sx:{fontWeight:"bold"},children:"Sensor Information"}),e.jsx(_,{container:!0,spacing:2,sx:{paddingTop:"1.5rem"},children:Object.keys(t).map((a,u)=>e.jsx(_,{item:!0,xs:6,children:e.jsx(V,{title:a,sx:{color:"text.cardTitle"},onClick:()=>{const n="/sensor/"+a.toLowerCase().replace(/\s/g,"");r(n,{state:{measurement:a,latestReading:t[a]}})},children:e.jsx(le,{sensor:a,sensorData:t,Icon:J(a)})})},u))})]})},de=()=>{const{deviceID:t}=C(),{getLatestReading:r}=G(),[a,u]=d.useState({}),[n,g]=d.useState({}),v=(m,x)=>{const o={};for(const l in m)x.hasOwnProperty(l)&&(o[l]=Math.round((m[l]-x[l])*100)/100);return o};return d.useEffect(()=>{async function m(){const o=await r(t);if(localStorage.getItem("sensorData")){const l=JSON.parse(localStorage.getItem("sensorData")),p=v(o,l);g(p)}localStorage.setItem("sensorData",JSON.stringify(o)),u(o)}m();const x=setInterval(()=>{m()},1*60*1e3);return()=>clearInterval(x)},[]),e.jsxs(M,{maxWidth:"xl",sx:{display:"flex",gap:"1rem",padding:"1.5rem"},children:[e.jsxs(s,{sx:{width:{xs:"100%",md:"70%"}},children:[e.jsx(ne,{sensorData:a,difference:n}),e.jsx(ce,{sensorData:a})]}),e.jsx(R,{orientation:"vertical",flexItem:!0,sx:{display:{xs:"none",md:"block"}}}),e.jsx(s,{sx:{width:"30%",display:{xs:"none",md:"block"}},children:e.jsx(U,{})})]})},Ce=()=>{const{hasDevice:t}=C(),[r,a]=d.useState(!0);return e.jsx(e.Fragment,{children:t?e.jsx(de,{}):e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(Y,{display:r,setShowAddDeviceModal:a})]})})};export{Ce as default};
